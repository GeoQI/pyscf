

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>14. cc — Coupled cluster &mdash; PySCF 1.5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PySCF 1.5.0 documentation" href="index.html"/>
        <link rel="next" title="15. ci — Configuration interaction" href="ci.html"/>
        <link rel="prev" title="13. tddft — Time dependent density functional theory" href="tddft.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">2. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gto.html">4. gto &#8212; Molecular structure and GTO basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">5. <code class="docutils literal"><span class="pre">lib</span></code> &#8212; Helper functions, parameters, and C extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="scf.html">6. scf &#8212; Mean-field methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="ao2mo.html">7. ao2mo &#8212; Integral transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcscf.html">8. mcscf &#8212; Multi-configurational self-consistent field</a></li>
<li class="toctree-l1"><a class="reference internal" href="fci.html">9. fci &#8212; Full configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="symm.html">10. symm &#8211; Point group symmetry and spin symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="df.html">11. df &#8212; Density fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft.html">12. dft &#8212; Density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="tddft.html">13. tddft &#8212; Time dependent density functional theory</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. cc &#8212; Coupled cluster</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples">14.1. Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-general-solver-for-customized-hamiltonian">14.1.1. A general solver for customized Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-ccsd-as-casci-active-space-solver">14.1.2. Using CCSD as CASCI active space solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gamma-point-ccsd-with-periodic-boundary-condition">14.1.3. Gamma point CCSD with Periodic boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ccsd-with-truncated-mos-to-avoid-linear-dependency">14.1.4. CCSD with truncated MOs to avoid linear dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#response-and-un-relaxed-ccsd-density-matrix">14.1.5. Response and un-relaxed CCSD density matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reusing-integrals-in-ccsd-and-relevant-calculations">14.1.6. Reusing integrals in CCSD and relevant calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interfering-ccsd-diis">14.1.7. Interfering CCSD-DIIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restart-ccsd">14.1.8. Restart CCSD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#program-reference">14.2. Program reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cc-ccsd-module-and-ccsd-class">14.2.1. cc.ccsd module and CCSD class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cc-rccsd-and-rccsd-class">14.2.2. cc.rccsd and RCCSD class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cc-uccsd-and-uccsd-class">14.2.3. cc.uccsd and UCCSD class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cc-addons">14.2.4. cc.addons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ccsd-t">14.2.5. CCSD(T)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscf.cc.ccsd_grad">14.2.6. CCSD gradients</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ci.html">15. ci &#8212; Configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmrgscf.html">16. dmrgscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="fciqmcscf.html">17. fciqmcscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">18. tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="grad.html">19. grad &#8212; Analytical nuclear gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">20. hessian &#8212; Analytical nuclear Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbc.html">21. pbc &#8212; Periodic boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="nao.html">22. nao &#8212; Numerical Atomic Orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="lo.html">23. lo &#8212; Orbital localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">24. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="qmmm.html">25. qmmm &#8212; QM/MM interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrpt.html">26. mrpt &#8212; Multi-reference perturbation theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">27. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-rule.html">28. Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">29. Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="gw.html">30. gw &#8212; Molecular G0W0</a></li>
<li class="toctree-l1"><a class="reference internal" href="hci.html">31. hci &#8212; Interface to Heat-Bath selective CI</a></li>
<li class="toctree-l1"><a class="reference internal" href="sgx.html">32. sgx &#8212; Pseudo-spectral methods (COSX, PS, SN-K)</a></li>
<li class="toctree-l1"><a class="reference internal" href="semiempirical.html">33. semiempirical &#8212; Semiempirical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="mp.html">34. mp &#8212; MP2</a></li>
<li class="toctree-l1"><a class="reference internal" href="semiempirical.html">33. semiempirical &#8212; Semiempirical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="soscf.html">35. soscf &#8212; Second order Hartree-Fock solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="icmpspt.html">36. icmpspt &#8212; Internal-contracted MPS perturbation method</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PySCF</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>14. cc &#8212; Coupled cluster</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/cc.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-cc">
<span id="cc-coupled-cluster"></span><span id="cc"></span><h1>14. cc &#8212; Coupled cluster<a class="headerlink" href="#module-cc" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-cc" title="cc: Computing coupled cluster energies and properties"><code class="xref py py-mod docutils literal"><span class="pre">cc</span></code></a> module implements the coupled cluster (CC) model to compute
energies, analytical nuclear gradients, density matrices, excited states, and
relevant properties.</p>
<p>To compute the CC energy, one first needs to perform a mean-field calculation using
the mean-field module <a class="reference internal" href="scf.html#module-scf" title="scf: restricted and unrestricted, closed shell and open shell Hartree-Fock methods"><code class="xref py py-mod docutils literal"><span class="pre">scf</span></code></a>.  The mean-field object defines the Hamiltonian
and the problem size, which are used to initialize the CC object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Unrelaxed density matrices are evaluated in the MO basis:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dm1</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="n">dm2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">make_rdm2</span><span class="p">()</span>
</pre></div>
</div>
<p>The CCSD(T) energy can be obtained by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf.cc</span> <span class="k">import</span> <span class="n">ccsd_t</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ccsd_t</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mycc</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ao2mo</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Gradients are available:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf.cc</span> <span class="k">import</span> <span class="n">ccsd_grad</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">grad</span>
<span class="n">grad_e</span> <span class="o">=</span> <span class="n">ccsd_grad</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mycc</span><span class="p">)</span>
<span class="n">grad_n</span> <span class="o">=</span> <span class="n">grad</span><span class="o">.</span><span class="n">grad_nuc</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">grad_e</span> <span class="o">+</span> <span class="n">grad_nuc</span>
</pre></div>
</div>
<p>Excited states can be calculated with ionization potential (IP), electron affinity (EA),
and electronic excitation (EE) equation-of-motion (EOM) CCSD:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RCCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">e_ip</span><span class="p">,</span> <span class="n">c_ip</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ipccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ea</span><span class="p">,</span> <span class="n">c_ea</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eaccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ee</span><span class="p">,</span> <span class="n">c_ee</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">UCCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">e_ip</span><span class="p">,</span> <span class="n">c_ip</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ipccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ea</span><span class="p">,</span> <span class="n">c_ea</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eaccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ee</span><span class="p">,</span> <span class="n">c_ee</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>All CC methods have two implementations.  One is simple and highly readable (suffixed
by <code class="docutils literal"><span class="pre">_slow</span></code> in the filename) and the other is extensively optimized for
computational efficiency.
All code in the <code class="docutils literal"><span class="pre">_slow</span></code> versions is structured as close as
possible to the formulas documented in the literature.  Pure Python/numpy
data structures and functions are used so that explicit memory management is avoided.
It is easy to make modifications or develop new methods based on the slow
implementations.</p>
<p>The computationally efficient (outcore) version is the default implementation
for the CC module.  In this implementation, the CPU usage, memory footprint,
memory efficiency, and IO overhead are carefully considered.  To keep a small
memory footprint, most integral tensors are stored on disk.  IO is one of the
main bottlenecks in this implementation.  Two techniques are used to reduce
the IO overhead.  One is the asynchronized IO to overlap the computation and
reading/writing of the 4-index tensors.  The other is AO-driven for the
contraction of T2 and <code class="docutils literal"><span class="pre">(vv|vv)</span></code> integrals in CCSD and CCSD-lambda functions.
These techniques allow the CC module to efficiently handle medium-sized
systems.  In a test system with 25 occupied orbitals and 1500 virtual orbitals, each
CCSD iteration takes about 2.5 hours.  The program does not automatically
switch to AO-driven CCSD for large systems.  The user must manually set the
<code class="xref py py-attr docutils literal"><span class="pre">direct</span></code> attribute to enable an AO-driven CCSD calculation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">direct</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Some of the CC methods have an efficient incore implementation, where
all tensors are held in memory.  The incore implementation reduces the IO overhead
and optimizes certain formulas to gain the best FLOPS.  It is about 30% faster
than the outcore implementation.  Depending on the available memory, the incore
code can be used for systems with up to approximately 250 orbitals.</p>
<p>Point group symmetry is not considered in the CCSD programs, but it is used in
the CCSD(T) code to gain the best performance.</p>
<p>Arbitrary frozen orbitals (not limited to frozen core) are supported
by the CCSD, CCSD(T), density matrices, and EOM-CCSD modules, but not in
the analytical CCSD gradient module.</p>
<div class="section" id="examples">
<h2>14.1. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This section documents some examples about how to effectively use the CCSD
module, and how to incorporate the CCSD solver with other PySCF functions to
perform advanced simulations.  For a complete list of CC examples, see
<code class="docutils literal"><span class="pre">pyscf/examples/cc</span></code>.</p>
<div class="section" id="a-general-solver-for-customized-hamiltonian">
<h3>14.1.1. A general solver for customized Hamiltonian<a class="headerlink" href="#a-general-solver-for-customized-hamiltonian" title="Permalink to this headline">¶</a></h3>
<p>The CC module is not limited to molecular systems.  The program is implemented as
a general solver for arbitrary Hamiltonians.  It allows users to overwrite the
default molecular Hamiltonian with their own effective Hamiltonians.  In this
example, we create a Hubbard model and feed its Hamiltonian to the CCSD module.</p>
</div>
<div class="section" id="using-ccsd-as-casci-active-space-solver">
<h3>14.1.2. Using CCSD as CASCI active space solver<a class="headerlink" href="#using-ccsd-as-casci-active-space-solver" title="Permalink to this headline">¶</a></h3>
<p>CCSD program can be wrapped as a Full CI solver, which can be combined with the
CASCI solver to approximate the multi-configuration calculation.</p>
</div>
<div class="section" id="gamma-point-ccsd-with-periodic-boundary-condition">
<h3>14.1.3. Gamma point CCSD with Periodic boundary condition<a class="headerlink" href="#gamma-point-ccsd-with-periodic-boundary-condition" title="Permalink to this headline">¶</a></h3>
<p>Integrals in Gamma point of periodic Hartree-Fock calculation are all real.
You can feed the integrals into any pyscf molecular module using the same
operations as the above example.  However, the interface between PBC code and
molecular code are more compatible.  You can treat the crystal object and the
molecule object in the same manner.  In this example, you can pass the PBC mean
field method to CC module to have the gamma point CCSD correlation.</p>
</div>
<div class="section" id="ccsd-with-truncated-mos-to-avoid-linear-dependency">
<h3>14.1.4. CCSD with truncated MOs to avoid linear dependency<a class="headerlink" href="#ccsd-with-truncated-mos-to-avoid-linear-dependency" title="Permalink to this headline">¶</a></h3>
<p>It is common to have linear dependence when one wants to systematically enlarge
the AO basis set to approach complete basis set limit.  The numerical
instability usually has noticeable effects on the CCSD convergence.  An
effective way to remove this negative effects is to truncate the AO sets and
allow the MO orbitals being less than AO functions.</p>
</div>
<div class="section" id="response-and-un-relaxed-ccsd-density-matrix">
<h3>14.1.5. Response and un-relaxed CCSD density matrix<a class="headerlink" href="#response-and-un-relaxed-ccsd-density-matrix" title="Permalink to this headline">¶</a></h3>
<p>CCSD has two kinds of one-particle density matrices.  The (second order)
un-relaxed density matrix and the (relaxed) response density matrix.  The
<code class="xref py py-func docutils literal"><span class="pre">CCSD.make_rdm1()</span></code> function computes the un-relaxed density matrix which is
associated to the regular CCSD energy formula.  The response density is mainly
used to compute the first order response quantities eg the analytical nuclear
gradients.  It is not recommended to use the response density matrix for
population analysis.</p>
</div>
<div class="section" id="reusing-integrals-in-ccsd-and-relevant-calculations">
<h3>14.1.6. Reusing integrals in CCSD and relevant calculations<a class="headerlink" href="#reusing-integrals-in-ccsd-and-relevant-calculations" title="Permalink to this headline">¶</a></h3>
<p>By default the CCSD solver and the relevant CCSD lambda solver, CCSD(T), CCSD
gradients program generate MO integrals in their own runtime.  But in most
scenario, the same MO integrals can be generated once and reused in the four
modules.  To remove the overhead of recomputing MO integrals, the three module
support user to feed MO integrals.</p>
</div>
<div class="section" id="interfering-ccsd-diis">
<h3>14.1.7. Interfering CCSD-DIIS<a class="headerlink" href="#interfering-ccsd-diis" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="restart-ccsd">
<h3>14.1.8. Restart CCSD<a class="headerlink" href="#restart-ccsd" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="program-reference">
<h2>14.2. Program reference<a class="headerlink" href="#program-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cc-ccsd-module-and-ccsd-class">
<h3>14.2.1. cc.ccsd module and CCSD class<a class="headerlink" href="#cc-ccsd-module-and-ccsd-class" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#pyscf.cc.ccsd.CCSD" title="pyscf.cc.ccsd.CCSD"><code class="xref py py-class docutils literal"><span class="pre">pyscf.cc.ccsd.CCSD</span></code></a> class is the object to hold the restricted CCSD environment
attributes and results.  The environment attributes are the parameters to
control the runtime behavior of the CCSD module, e.g. the convergence criteria, DIIS
parameters, and so on.  After the ground state CCSD calculation, correlation
energy, <code class="docutils literal"><span class="pre">T1</span></code> and <code class="docutils literal"><span class="pre">T2</span></code> amplitudes are stored in the CCSD object.
This class supports the calculation of CCSD 1- and 2-particle density matrices.</p>
<dl class="class">
<dt id="pyscf.cc.ccsd.CCSD">
<em class="property">class </em><code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">CCSD</code><span class="sig-paren">(</span><em>mf</em>, <em>frozen=0</em>, <em>mo_coeff=None</em>, <em>mo_occ=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#CCSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.CCSD" title="Permalink to this definition">¶</a></dt>
<dd><p>restricted CCSD</p>
<dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.verbose</span></code></dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.max_memory</span></code></dd>
<dt>conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>converge threshold.  Default is 1e-7.</dd>
<dt>conv_tol_normt</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>converge threshold for norm(t1,t2).  Default is 1e-5.</dd>
<dt>max_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>max number of iterations.  Default is 50.</dd>
<dt>diis_space</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>DIIS space size.  Default is 6.</dd>
<dt>diis_start_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>The step to start DIIS.  Default is 0.</dd>
<dt>iterative_damping</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>The self consistent damping parameter.</dd>
<dt>direct</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>AO-direct CCSD. Default is False.</dd>
<dt>async_io</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Allow for asynchronous function execution. Default is True.</dd>
<dt>incore_complete</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Avoid all I/O (also for DIIS). Default is False.</dd>
<dt>level_shift</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>A shift on virtual orbital energies to stablize the CCSD iteration</dd>
<dt>frozen</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or list</span><dd><p class="first">If integer is given, the inner-most orbitals are frozen from CC
amplitudes.  Given the orbital indices (0-based) in a list, both
occupied and virtual orbitals can be frozen in CC calculation.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;H 0 0 0; F 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># freeze 2 core orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frozen</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># freeze 2 core orbitals and 3 high lying unoccupied orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycc</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frozen</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>converged</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>CCSD converged or not</dd>
<dt>e_corr</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>CCSD correlation correction</dd>
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total CCSD energy (HF + correlation)</dd>
<dt>t1, t2 :</dt>
<dd>T amplitudes t1[i,a], t2[i,j,a,b]  (i,j in occ, a,b in virt)</dd>
<dt>l1, l2 :</dt>
<dd>Lambda amplitudes l1[i,a], l2[i,j,a,b]  (i,j in occ, a,b in virt)</dd>
</dl>
</div></blockquote>
</dd></dl>

<span class="target" id="module-pyscf.cc.ccsd"></span><p>RCCSD for real integrals
8-fold permutation symmetry has been used
(ij|kl) = (ji|kl) = (kl|ij) = ...</p>
<dl class="attribute">
<dt id="pyscf.cc.ccsd.CC">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">CC</code><a class="headerlink" href="#pyscf.cc.ccsd.CC" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.cc.ccsd.CCSD" title="pyscf.cc.ccsd.CCSD"><code class="xref py py-class docutils literal"><span class="pre">CCSD</span></code></a></p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">CCSD</code><span class="sig-paren">(</span><em>mf</em>, <em>frozen=0</em>, <em>mo_coeff=None</em>, <em>mo_occ=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#CCSD"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>restricted CCSD</p>
<dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.verbose</span></code></dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.max_memory</span></code></dd>
<dt>conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>converge threshold.  Default is 1e-7.</dd>
<dt>conv_tol_normt</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>converge threshold for norm(t1,t2).  Default is 1e-5.</dd>
<dt>max_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>max number of iterations.  Default is 50.</dd>
<dt>diis_space</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>DIIS space size.  Default is 6.</dd>
<dt>diis_start_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>The step to start DIIS.  Default is 0.</dd>
<dt>iterative_damping</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>The self consistent damping parameter.</dd>
<dt>direct</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>AO-direct CCSD. Default is False.</dd>
<dt>async_io</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Allow for asynchronous function execution. Default is True.</dd>
<dt>incore_complete</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Avoid all I/O (also for DIIS). Default is False.</dd>
<dt>level_shift</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>A shift on virtual orbital energies to stablize the CCSD iteration</dd>
<dt>frozen</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or list</span><dd><p class="first">If integer is given, the inner-most orbitals are frozen from CC
amplitudes.  Given the orbital indices (0-based) in a list, both
occupied and virtual orbitals can be frozen in CC calculation.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;H 0 0 0; F 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># freeze 2 core orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frozen</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># freeze 2 core orbitals and 3 high lying unoccupied orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycc</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frozen</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>converged</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>CCSD converged or not</dd>
<dt>e_corr</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>CCSD correlation correction</dd>
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total CCSD energy (HF + correlation)</dd>
<dt>t1, t2 :</dt>
<dd>T amplitudes t1[i,a], t2[i,j,a,b]  (i,j in occ, a,b in virt)</dd>
<dt>l1, l2 :</dt>
<dd>Lambda amplitudes l1[i,a], l2[i,j,a,b]  (i,j in occ, a,b in virt)</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.EOMEA_Ta">
<code class="descname">EOMEA_Ta</code><span class="sig-paren">(</span><em>obj</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.EOMEA_Ta" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for EOM EACCSD(T)*(a) method by Matthews and Stanton.</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.EOMIP_Ta">
<code class="descname">EOMIP_Ta</code><span class="sig-paren">(</span><em>obj</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.EOMIP_Ta" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for EOM IPCCSD(T)*(a) method by Matthews and Stanton.</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.as_scanner">
<code class="descname">as_scanner</code><span class="sig-paren">(</span><em>cc</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.as_scanner" title="Permalink to this definition">¶</a></dt>
<dd><p>Generating a scanner/solver for CCSD PES.</p>
<p>The returned solver is a function. This function requires one argument
&#8220;mol&#8221; as input and returns total CCSD energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters assigned in the
CCSD and the underlying SCF objects (conv_tol, max_memory etc) are
automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ...) during calculation.</p>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cc_scanner</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_tot</span> <span class="o">=</span> <span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1.1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_tot</span> <span class="o">=</span> <span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1.5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.energy">
<code class="descname">energy</code><span class="sig-paren">(</span><em>mycc</em>, <em>t1=None</em>, <em>t2=None</em>, <em>eris=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>CCSD correlation energy</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.get_frozen_mask">
<code class="descname">get_frozen_mask</code><span class="sig-paren">(</span><em>mp</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.get_frozen_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Get boolean mask for the restricted reference orbitals.</p>
<p>In the returned boolean (mask) array of frozen orbital indices, the
element is False if it corresonds to the frozen orbital.</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.make_rdm1">
<code class="descname">make_rdm1</code><span class="sig-paren">(</span><em>t1=None</em>, <em>t2=None</em>, <em>l1=None</em>, <em>l2=None</em>, <em>ao_repr=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#CCSD.make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Un-relaxed 1-particle density matrix in MO space</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.make_rdm2">
<code class="descname">make_rdm2</code><span class="sig-paren">(</span><em>t1=None</em>, <em>t2=None</em>, <em>l1=None</em>, <em>l2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#CCSD.make_rdm2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.make_rdm2" title="Permalink to this definition">¶</a></dt>
<dd><p>2-particle density matrix in MO space.  The density matrix is
stored as</p>
<p>dm2[p,r,q,s] = &lt;p^+ q^+ s r&gt;</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.ccsd.CCSD.restore_from_diis_">
<code class="descname">restore_from_diis_</code><span class="sig-paren">(</span><em>mycc</em>, <em>diis_file</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd.CCSD.restore_from_diis_" title="Permalink to this definition">¶</a></dt>
<dd><p>Reuse an existed DIIS object in the CCSD calculation.</p>
<p>The CCSD amplitudes will be restored from the DIIS object to generate t1
and t2 amplitudes. The t1/t2 amplitudes of the CCSD object will be
overwritten by the generated t1 and t2 amplitudes. The amplitudes vector
and error vector will be reused in the CCSD calculation.</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="pyscf.cc.ccsd.RCCSD">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">RCCSD</code><a class="headerlink" href="#pyscf.cc.ccsd.RCCSD" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.cc.ccsd.CCSD" title="pyscf.cc.ccsd.CCSD"><code class="xref py py-class docutils literal"><span class="pre">CCSD</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.ccsd.as_scanner">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">as_scanner</code><span class="sig-paren">(</span><em>cc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#as_scanner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.as_scanner" title="Permalink to this definition">¶</a></dt>
<dd><p>Generating a scanner/solver for CCSD PES.</p>
<p>The returned solver is a function. This function requires one argument
&#8220;mol&#8221; as input and returns total CCSD energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters assigned in the
CCSD and the underlying SCF objects (conv_tol, max_memory etc) are
automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ...) during calculation.</p>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cc_scanner</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_tot</span> <span class="o">=</span> <span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1.1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_tot</span> <span class="o">=</span> <span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1.5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.ccsd.energy">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">energy</code><span class="sig-paren">(</span><em>mycc</em>, <em>t1=None</em>, <em>t2=None</em>, <em>eris=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>CCSD correlation energy</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.ccsd.get_d1_diagnostic">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">get_d1_diagnostic</code><span class="sig-paren">(</span><em>t1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#get_d1_diagnostic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.get_d1_diagnostic" title="Permalink to this definition">¶</a></dt>
<dd><p>D1 diagnostic given in</p>
<p>Janssen, et. al Chem. Phys. Lett. 290 (1998) 423</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.ccsd.get_d2_diagnostic">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">get_d2_diagnostic</code><span class="sig-paren">(</span><em>t2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#get_d2_diagnostic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.get_d2_diagnostic" title="Permalink to this definition">¶</a></dt>
<dd><p>D2 diagnostic given in</p>
<blockquote>
<div>Nielsen, et. al Chem. Phys. Lett. 310 (1999) 568</div></blockquote>
<p>Note: This is currently only defined in the literature for restricted
closed-shell systems.</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.ccsd.get_t1_diagnostic">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">get_t1_diagnostic</code><span class="sig-paren">(</span><em>t1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#get_t1_diagnostic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.get_t1_diagnostic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the t1 amplitude norm, normalized by number of correlated electrons.</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.ccsd.restore_from_diis_">
<code class="descclassname">pyscf.cc.ccsd.</code><code class="descname">restore_from_diis_</code><span class="sig-paren">(</span><em>mycc</em>, <em>diis_file</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/ccsd.html#restore_from_diis_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.ccsd.restore_from_diis_" title="Permalink to this definition">¶</a></dt>
<dd><p>Reuse an existed DIIS object in the CCSD calculation.</p>
<p>The CCSD amplitudes will be restored from the DIIS object to generate t1
and t2 amplitudes. The t1/t2 amplitudes of the CCSD object will be
overwritten by the generated t1 and t2 amplitudes. The amplitudes vector
and error vector will be reused in the CCSD calculation.</p>
</dd></dl>

</div>
<div class="section" id="cc-rccsd-and-rccsd-class">
<h3>14.2.2. cc.rccsd and RCCSD class<a class="headerlink" href="#cc-rccsd-and-rccsd-class" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#pyscf.cc.rccsd.RCCSD" title="pyscf.cc.rccsd.RCCSD"><code class="xref py py-class docutils literal"><span class="pre">pyscf.cc.rccsd.RCCSD</span></code></a> is also a class for restricted CCSD calculations, but
different to the <a class="reference internal" href="#pyscf.cc.ccsd.CCSD" title="pyscf.cc.ccsd.CCSD"><code class="xref py py-class docutils literal"><span class="pre">pyscf.cc.ccsd.CCSD</span></code></a> class.  It uses different formula
to compute the ground state CCSD solution.  Although slower than the
implmentation in the <a class="reference internal" href="#pyscf.cc.ccsd.CCSD" title="pyscf.cc.ccsd.CCSD"><code class="xref py py-class docutils literal"><span class="pre">pyscf.cc.ccsd.CCSD</span></code></a> class, it supports the system
with complex integrals.  Another difference is that this class supports EOM-CCSD
methods, including EOM-IP-CCSD, EOM-EA-CCSD, EOM-EE-CCSD, EOM-SF-CCSD.</p>
<dl class="class">
<dt id="pyscf.cc.rccsd.RCCSD">
<em class="property">class </em><code class="descclassname">pyscf.cc.rccsd.</code><code class="descname">RCCSD</code><span class="sig-paren">(</span><em>mf</em>, <em>frozen=0</em>, <em>mo_coeff=None</em>, <em>mo_occ=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/rccsd.html#RCCSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.rccsd.RCCSD" title="Permalink to this definition">¶</a></dt>
<dd><p>restricted CCSD with IP-EOM, EA-EOM, EE-EOM, and SF-EOM capabilities</p>
<p>Ground-state CCSD is performed in optimized ccsd.CCSD and EOM is performed here.</p>
</dd></dl>

<span class="target" id="module-pyscf.cc.rccsd"></span><p>Restricted CCSD implementation which supports both real and complex integrals.
The 4-index integrals are saved on disk entirely (without using any symmetry).
This code is slower than the pyscf.cc.ccsd implementation.</p>
<p>Note MO integrals are treated in chemist&#8217;s notation</p>
<p>Ref: Hirata et al., J. Chem. Phys. 120, 2581 (2004)</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pyscf.cc.rccsd.</code><code class="descname">RCCSD</code><span class="sig-paren">(</span><em>mf</em>, <em>frozen=0</em>, <em>mo_coeff=None</em>, <em>mo_occ=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/rccsd.html#RCCSD"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>restricted CCSD with IP-EOM, EA-EOM, EE-EOM, and SF-EOM capabilities</p>
<p>Ground-state CCSD is performed in optimized ccsd.CCSD and EOM is performed here.</p>
<dl class="method">
<dt id="pyscf.cc.rccsd.RCCSD.ccsd">
<code class="descname">ccsd</code><span class="sig-paren">(</span><em>t1=None</em>, <em>t2=None</em>, <em>eris=None</em>, <em>mbpt2=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/rccsd.html#RCCSD.ccsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.rccsd.RCCSD.ccsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Ground-state CCSD.</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>mbpt2</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Use one-shot MBPT2 approximation to CCSD.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.cc.rccsd.RCCSD.energy">
<code class="descname">energy</code><span class="sig-paren">(</span><em>cc</em>, <em>t1=None</em>, <em>t2=None</em>, <em>eris=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.rccsd.RCCSD.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>RCCSD correlation energy</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyscf.cc.rccsd.energy">
<code class="descclassname">pyscf.cc.rccsd.</code><code class="descname">energy</code><span class="sig-paren">(</span><em>cc</em>, <em>t1=None</em>, <em>t2=None</em>, <em>eris=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/rccsd.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.rccsd.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>RCCSD correlation energy</p>
</dd></dl>

</div>
<div class="section" id="cc-uccsd-and-uccsd-class">
<h3>14.2.3. cc.uccsd and UCCSD class<a class="headerlink" href="#cc-uccsd-and-uccsd-class" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#pyscf.cc.uccsd.UCCSD" title="pyscf.cc.uccsd.UCCSD"><code class="xref py py-class docutils literal"><span class="pre">pyscf.cc.uccsd.UCCSD</span></code></a> class supports the CCSD calculation based on UHF
wavefunction as well as the ROHF wavefunction.  Besides the ground state UCCSD calculation,
UCCSD lambda equation, 1-particle and 2-particle density matrices, EOM-IP-CCSD,
EOM-EA-CCSD, EOM-EE-CCSD are all available in this class.  Note this class does
not support complex integrals.</p>
<dl class="class">
<dt id="pyscf.cc.uccsd.UCCSD">
<em class="property">class </em><code class="descclassname">pyscf.cc.uccsd.</code><code class="descname">UCCSD</code><span class="sig-paren">(</span><em>mf</em>, <em>frozen=0</em>, <em>mo_coeff=None</em>, <em>mo_occ=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/uccsd.html#UCCSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.uccsd.UCCSD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-pyscf.cc.uccsd"></span><p>UCCSD with spatial integrals</p>
<dl class="function">
<dt id="pyscf.cc.uccsd.energy">
<code class="descclassname">pyscf.cc.uccsd.</code><code class="descname">energy</code><span class="sig-paren">(</span><em>cc</em>, <em>t1=None</em>, <em>t2=None</em>, <em>eris=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/uccsd.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.uccsd.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>UCCSD correlation energy</p>
</dd></dl>

</div>
<div class="section" id="cc-addons">
<h3>14.2.4. cc.addons<a class="headerlink" href="#cc-addons" title="Permalink to this headline">¶</a></h3>
<p>Helper functions for CCSD, RCCSD and UCCSD modules are implemented in
<code class="xref py py-mod docutils literal"><span class="pre">cc.addons</span></code></p>
<span class="target" id="module-pyscf.cc.addons"></span><dl class="function">
<dt id="pyscf.cc.addons.spatial2spin">
<code class="descclassname">pyscf.cc.addons.</code><code class="descname">spatial2spin</code><span class="sig-paren">(</span><em>tx</em>, <em>orbspin=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/cc/addons.html#spatial2spin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.cc.addons.spatial2spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert T1/T2 of spatial orbital representation to T1/T2 of
spin-orbital representation</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.cc.addons.spatial2spinorb">
<code class="descclassname">pyscf.cc.addons.</code><code class="descname">spatial2spinorb</code><span class="sig-paren">(</span><em>tx</em>, <em>orbspin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.addons.spatial2spinorb" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert T1/T2 of spatial orbital representation to T1/T2 of
spin-orbital representation</p>
</dd></dl>

</div>
<div class="section" id="ccsd-t">
<h3>14.2.5. CCSD(T)<a class="headerlink" href="#ccsd-t" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-pyscf.cc.ccsd_t"></span><p>RHF-CCSD(T) for real integrals</p>
</div>
<div class="section" id="module-pyscf.cc.ccsd_grad">
<span id="ccsd-gradients"></span><h3>14.2.6. CCSD gradients<a class="headerlink" href="#module-pyscf.cc.ccsd_grad" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pyscf.cc.ccsd_grad.as_scanner">
<code class="descclassname">pyscf.cc.ccsd_grad.</code><code class="descname">as_scanner</code><span class="sig-paren">(</span><em>cc</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.cc.ccsd_grad.as_scanner" title="Permalink to this definition">¶</a></dt>
<dd><p>Generating a scanner/solver for CCSD PES.</p>
<p>The returned solver is a function. This function requires one argument
&#8220;mol&#8221; as input and returns total CCSD energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters assigned in the
CCSD and the underlying SCF objects (conv_tol, max_memory etc) are
automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ...) during calculation.</p>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cc_scanner</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_tot</span><span class="p">,</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1.1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_tot</span><span class="p">,</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1.5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ci.html" class="btn btn-neutral float-right" title="15. ci — Configuration interaction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tddft.html" class="btn btn-neutral" title="13. tddft — Time dependent density functional theory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-, Qiming Sun &lt;osirpt.sun@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>