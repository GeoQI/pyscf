

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Installation &mdash; PySCF 1.7.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Code standard" href="code-rule.html" />
    <link rel="prev" title="2. Version history" href="version.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">2. Version history</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-with-pip">3.1. Installation with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-with-conda">3.2. Installation with conda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyscf-docker-image">3.3. PySCF docker image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manual-installation-from-github-repo">3.4. Manual installation from github repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-without-network">3.5. Installation without network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-optimized-blas">3.6. Using optimized BLAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-optimized-integral-library">3.7. Using optimized integral library</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cmake-config-file">3.8. Cmake config file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plugins">3.9. Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nao">3.9.1. NAO</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dmrg-solver">3.9.2. DMRG solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">3.9.3. Libxc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">3.9.4. Xcfun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tblis">3.9.5. TBLIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyberny">3.9.6. Pyberny</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code-rule.html">4. Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">5. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">6. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">7. Theoretical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">8. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">9. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">10. Main modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PySCF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">3. </span>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/install.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<span id="installing"></span><h1><span class="section-number">3. </span>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation-with-pip">
<h2><span class="section-number">3.1. </span>Installation with pip<a class="headerlink" href="#installation-with-pip" title="Permalink to this headline">¶</a></h2>
<p>This is the recommended way to install PySCF:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install pyscf
</pre></div>
</div>
<p>Pypi provides a precompiled PySCF code (python wheel) which works on almost all
Linux systems, and most of Mac OS X systems, and the ubuntu subsystems on Windows 10.
If you already have pyscf installed, you can upgrade it to the new version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install --upgrade pyscf
</pre></div>
</div>
<p>Note we observed that our precompiled python wheels sometimes does not work with
certain version of Python (python-3.4 and python-3.5).  If you’re using mac OS X
with python-3.4 or python-3.5, pip may execute the setup.py file in the source
code and it may be terminated due to an error of library path of BLAS library.
BLAS library is required to install PySCF library.  The installation script can
detect the installed BLAS libraries in the system and choose one for the
program.  If BLAS library is existed but wasn’t found by the installation
script, you can specify the BLAS library either through the environment
<code class="docutils literal notranslate"><span class="pre">LDFLAGS</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">LDFLAGS=&quot;-L/path/to/blas</span> <span class="pre">-lblas&quot;</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyscf</span></code> or the
environment variable <code class="docutils literal notranslate"><span class="pre">PYSCF_INC_DIR</span></code>, e.g.
<code class="docutils literal notranslate"><span class="pre">PYSCF_INC_DIR=/path/to/blas:/path/to/other/lib</span> <span class="pre">pip</span> <span class="pre">install</span></code> to tell the
installation script which BLAS libraries to link against.
Another issue of the installation script you may get is that pyscf.dft module is
not working.  pyscf.dft module requires the exchange-correlation functional
library <code class="docutils literal notranslate"><span class="pre">libxc</span></code> which was not yet available in the PyPI repository. To enable
pyscf.dft module, you can download and manually compile libxc library and set
the environment variable <code class="docutils literal notranslate"><span class="pre">PYSCF_INC_DIR</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PYSCF_INC_DIR=/path/to/libxc</span></code>
before calling <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> command.  Libxc library can be found in
<a class="reference external" href="http://octopus-code.org/wiki/Libxc:download">http://octopus-code.org/wiki/Libxc:download</a>.  When compiling the libxc library,
you need to add –enable-shared flag.</p>
<p>Geometry optimization module is not installed by default. You can install the
<code class="docutils literal notranslate"><span class="pre">geomopt</span></code> module using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install pyscf[geomopt]
</pre></div>
</div>
</div>
<div class="section" id="installation-with-conda">
<h2><span class="section-number">3.2. </span>Installation with conda<a class="headerlink" href="#installation-with-conda" title="Permalink to this headline">¶</a></h2>
<p>If you have <a class="reference external" href="https://conda.io/docs/">Conda</a>
(or <a class="reference external" href="https://www.continuum.io/downloads#linux">Anaconda</a>)
environment, PySCF package can be installed with Conda cloud:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install -c pyscf pyscf
</pre></div>
</div>
</div>
<div class="section" id="pyscf-docker-image">
<h2><span class="section-number">3.3. </span>PySCF docker image<a class="headerlink" href="#pyscf-docker-image" title="Permalink to this headline">¶</a></h2>
<p>The following command starts a container with the jupyter notebook server
listening for HTTP connections on port 8888:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker run -it -p 8888:8888 pyscf/pyscf-1.5.0
</pre></div>
</div>
<p>Then visit <code class="docutils literal notranslate"><span class="pre">https://localhost:8888</span></code> with your browser to use notebook and
pyscf.</p>
<p>Another way to use PySCF in docker container is to start an Ipython shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker run -it pyscf/pyscf-1.5.0 start.sh ipython
</pre></div>
</div>
</div>
<div class="section" id="manual-installation-from-github-repo">
<h2><span class="section-number">3.4. </span>Manual installation from github repo<a class="headerlink" href="#manual-installation-from-github-repo" title="Permalink to this headline">¶</a></h2>
<p>Manual installation requires <a class="reference external" href="http://www.cmake.org">cmake</a>,
<a class="reference external" href="http://www.numpy.org/">numpy</a>, <a class="reference external" href="http://www.scipy.org/">scipy</a>
and <a class="reference external" href="http://www.h5py.org/">h5py</a> libraries.
You can download the latest PySCF (or the development branch) from github:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/sunqm/pyscf
$ cd pyscf
$ git checkout dev  # optional if you&#39;d like to try out the development branch
</pre></div>
</div>
<p>Build the C extensions in <code class="file docutils literal notranslate"><span class="pre">pyscf/lib</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd pyscf/lib
$ mkdir build
$ cd build
$ cmake ..
$ make
</pre></div>
</div>
<p>This will automatically download the analytical GTO integral library <a class="reference external" href="https://github.com/sunqm/libcint.git">libcint</a> and the DFT exchange correlation
functional libraries <a class="reference external" href="http://www.tddft.org/programs/Libxc">libxc</a> and <a class="reference external" href="https://github.com/dftlibs/xcfun.git">xcfun</a>.  Finally, to make Python find
the <code class="code docutils literal notranslate"><span class="pre">pyscf</span></code> package, add the top-level <code class="code docutils literal notranslate"><span class="pre">pyscf</span></code> directory (not
the <code class="code docutils literal notranslate"><span class="pre">pyscf/pyscf</span></code> subdirectory) to <code class="code docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>.  For example, if
<code class="code docutils literal notranslate"><span class="pre">pyscf</span></code> is installed in <code class="docutils literal notranslate"><span class="pre">/opt</span></code>, <code class="code docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> should be like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PYTHONPATH=/opt/pyscf:$PYTHONPATH
</pre></div>
</div>
<p>To ensure the installation is successful, start a Python shell, and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyscf</span>
</pre></div>
</div>
<p>For Mac OS X/macOS, you may get an import error if your OS X/macOS version is
10.11 or newer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">OSError</span><span class="p">:</span> <span class="n">dlopen</span><span class="p">(</span><span class="n">xxx</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libcgto</span><span class="o">.</span><span class="n">dylib</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="n">Library</span> <span class="ow">not</span> <span class="n">loaded</span><span class="p">:</span> <span class="n">libcint</span><span class="o">.</span><span class="mf">3.0</span><span class="o">.</span><span class="n">dylib</span>
<span class="n">Referenced</span> <span class="n">from</span><span class="p">:</span> <span class="n">xxx</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libcgto</span><span class="o">.</span><span class="n">dylib</span>
<span class="n">Reason</span><span class="p">:</span> <span class="n">unsafe</span> <span class="n">use</span> <span class="n">of</span> <span class="n">relative</span> <span class="n">rpath</span> <span class="n">libcint</span><span class="o">.</span><span class="mf">3.0</span><span class="o">.</span><span class="n">dylib</span> <span class="ow">in</span> <span class="n">xxx</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libcgto</span><span class="o">.</span><span class="n">dylib</span> <span class="k">with</span> <span class="n">restricted</span> <span class="n">binary</span>
</pre></div>
</div>
<p>This is caused by the incorrect RPATH.  Script
<code class="docutils literal notranslate"><span class="pre">pyscf/lib/_runme_to_fix_dylib_osx10.11.sh</span></code> in <code class="docutils literal notranslate"><span class="pre">pyscf/lib</span></code> directory can be
used to fix this problem:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">pyscf</span><span class="o">/</span><span class="n">lib</span>
<span class="n">sh</span> <span class="n">_runme_to_fix_dylib_osx10</span><span class="o">.</span><span class="mf">11.</span><span class="n">sh</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RPATH has been built in the dynamic library.  This may cause library loading
error on some systems.  You can run <code class="docutils literal notranslate"><span class="pre">pyscf/lib/_runme_to_remove_rpath.sh</span></code> to
remove the rpath code from the library head.  Another workaround is to set
<code class="docutils literal notranslate"><span class="pre">-DCMAKE_SKIP_RPATH=1</span></code> and <code class="docutils literal notranslate"><span class="pre">-DCMAKE_MACOSX_RPATH=0</span></code> in cmake command line.
When the RPATH was removed, you need to add <code class="docutils literal notranslate"><span class="pre">pyscf/lib</span></code> and
<code class="docutils literal notranslate"><span class="pre">pyscf/lib/deps/lib</span></code> in <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code>.</p>
</div>
<p>Last, it’s recommended to set a scratch directory for PySCF.  The default scratch
directory is controlled by environment variable <code class="code docutils literal notranslate"><span class="pre">PYSCF_TMPDIR</span></code>.  If it’s
not specified, the system temporary directory <code class="code docutils literal notranslate"><span class="pre">TMPDIR</span></code> will be used as the
scratch directory.</p>
</div>
<div class="section" id="installation-without-network">
<h2><span class="section-number">3.5. </span>Installation without network<a class="headerlink" href="#installation-without-network" title="Permalink to this headline">¶</a></h2>
<p>If you have problems to download the external libraries on your computer, you can
manually build the libraries, as shown in the following instructions.  First,
you need to install libcint, libxc or xcfun libraries.</p>
<blockquote>
<div><p>$ git clone <a class="reference external" href="https://github.com/sunqm/libcint.git">https://github.com/sunqm/libcint.git</a>
$ cd libcint
$ cd .. &amp;&amp; tar czf libcint.tar.gz libcint</p>
<p>$ git clone <a class="reference external" href="https://github.com/dftlibs/xcfun.git">https://github.com/dftlibs/xcfun.git</a>
$ cd xcfun
$ # PySCF depends on this version of xcfun
$ git checkout 355f42497a9cd17d16ae91da1f1aaaf93756ae8b
$ cd .. &amp;&amp; tar czf xcfun.tar.gz xcfun</p>
</div></blockquote>
<p>libxc downloaded from
<a class="reference external" href="http://sunqm.net/pyscf/files/src/libxc-4.3.4.tar.gz">here</a>.
Assuming <code class="docutils literal notranslate"><span class="pre">/opt</span></code> is the place where these libraries will be installed, these
packages should be compiled with the flags:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tar xvzf libcint.tar.gz
$ cd libcint
$ mkdir build &amp;&amp; cd build
$ cmake -DWITH_F12=1 -DWITH_RANGE_COULOMB=1 -DWITH_COULOMB_ERF=1 \
    -DCMAKE_INSTALL_PREFIX:PATH=/opt -DCMAKE_INSTALL_LIBDIR:PATH=lib ..
$ make &amp;&amp; make install

$ tar xvzf libxc-4.3.4.tar.gz
$ cd libxc-4.3.4
$ mkdir build &amp;&amp; cd build
$ ../configure --prefix=/opt --libdir=/opt/lib --enable-vxc --enable-fxc --enable-kxc \
    --enable-shared --disable-static --enable-shared --disable-fortran LIBS=-lm
$ make &amp;&amp; make install

$ tar xvzf xcfun.tar.gz
$ cd xcfun
$ mkdir build &amp;&amp; cd build
$ cmake -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_SHARED_LIBS=1 -DXC_MAX_ORDER=3 -DXCFUN_ENABLE_TESTS=0 \
    -DCMAKE_INSTALL_PREFIX:PATH=/opt -DCMAKE_INSTALL_LIBDIR:PATH=lib ..
$ make &amp;&amp; make install
</pre></div>
</div>
<p>Next, compile PySCF:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd pyscf/pyscf/lib
$ mkdir build &amp;&amp; cd build
$ cmake -DBUILD_LIBCINT=0 -DBUILD_LIBXC=0 -DBUILD_XCFUN=0 -DCMAKE_INSTALL_PREFIX:PATH=/opt ..
$ make
</pre></div>
</div>
<p>Finally update the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> environment for Python interpreter.</p>
</div>
<div class="section" id="using-optimized-blas">
<span id="installing-blas"></span><h2><span class="section-number">3.6. </span>Using optimized BLAS<a class="headerlink" href="#using-optimized-blas" title="Permalink to this headline">¶</a></h2>
<p>The default installation tries to find BLAS libraries automatically. This
automated setup script may link the code to slow BLAS libraries.  You can
compile the package with other BLAS vendors to improve performance, for example
the Intel Math Kernel Library (MKL), which can provide 10x speedup in many
modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd pyscf/lib/build
$ cmake -DBLA_VENDOR=Intel10_64lp_seq ..
$ make
</pre></div>
</div>
<p>When linking the program to MKL library, for some MKL versions, cmake may have
problems to find the correct MKL libraries.  Setting <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> to
include the MKL dynamic libraries sometimes can help cmake to find the MKL
libraries, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export LD_LIBRARY_PATH=/opt/intel/compilers_and_libraries_2018/linux/mkl/lib/intel64:$LD_LIBRARY_PATH
</pre></div>
</div>
<p>If you are using Anaconda as your Python-side platform, you can link PySCF
to the MKL library coming with Anaconda package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export MKLROOT=/path/to/anaconda2
$ export LD_LIBRARY_PATH=$MKLROOT/lib:$LD_LIBRARY_PATH
$ cd pyscf/lib/build
$ cmake -DBLA_VENDOR=Intel10_64lp_seq ..
$ make
</pre></div>
</div>
<p>You can link to other BLAS libraries by setting <code class="docutils literal notranslate"><span class="pre">BLA_VENDOR</span></code>, eg
<code class="docutils literal notranslate"><span class="pre">BLA_VENDOR=ATLAS</span></code>, <code class="docutils literal notranslate"><span class="pre">BLA_VENDOR=IBMESSL</span></code>, <code class="docutils literal notranslate"><span class="pre">BLA_VENDOR=OpenBLAS</span></code> (requiring cmake-3.6).
Please refer to <a class="reference external" href="http://www.cmake.org/cmake/help/v3.6/module/FindBLAS.html">cmake mannual</a>
for more details of the use of <code class="docutils literal notranslate"><span class="pre">FindBLAS</span></code> macro.</p>
<p>If the cmake <code class="docutils literal notranslate"><span class="pre">BLA_VENDOR</span></code> cannot find the right BLAS library as you expected,
you can assign the libraries to the variable <code class="docutils literal notranslate"><span class="pre">BLAS_LIBRARIES</span></code> in
<code class="file docutils literal notranslate"><span class="pre">lib/CMakeLists.txt</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">BLAS_LIBRARIES</span> <span class="s2">&quot;$</span><span class="si">{BLAS_LIBRARIES}</span><span class="s2">;/path/to/mkl/lib/intel64/libmkl_intel_lp64.so&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="n">BLAS_LIBRARIES</span> <span class="s2">&quot;$</span><span class="si">{BLAS_LIBRARIES}</span><span class="s2">;/path/to/mkl/lib/intel64/libmkl_sequential.so&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="n">BLAS_LIBRARIES</span> <span class="s2">&quot;$</span><span class="si">{BLAS_LIBRARIES}</span><span class="s2">;/path/to/mkl/lib/intel64/libmkl_core.so&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="n">BLAS_LIBRARIES</span> <span class="s2">&quot;$</span><span class="si">{BLAS_LIBRARIES}</span><span class="s2">;/path/to/mkl/lib/intel64/libmkl_avx.so&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MKL library may lead to an OSError at runtime:
<code class="docutils literal notranslate"><span class="pre">OSError:</span> <span class="pre">...</span> <span class="pre">mkl/lib/intel64/libmkl_avx.so:</span> <span class="pre">undefined</span> <span class="pre">symbol:</span> <span class="pre">ownLastTriangle_64fc</span></code>
or <code class="docutils literal notranslate"><span class="pre">MKL</span> <span class="pre">FATAL</span> <span class="pre">ERROR:</span> <span class="pre">Cannot</span> <span class="pre">load</span> <span class="pre">libmkl_avx.so</span> <span class="pre">or</span> <span class="pre">libmkl_def.so.</span></code>.
It can be solved by preloading MKL core library with:
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">LD_PRELOAD=$MKLROOT/lib/intel64/libmkl_avx.so:$MKLROOT/lib/intel64/libmkl_core.so</span></code></p>
</div>
</div>
<div class="section" id="using-optimized-integral-library">
<span id="installing-qcint"></span><h2><span class="section-number">3.7. </span>Using optimized integral library<a class="headerlink" href="#using-optimized-integral-library" title="Permalink to this headline">¶</a></h2>
<p>The default integral library used by PySCF is
libcint (<a class="reference external" href="https://github.com/sunqm/libcint">https://github.com/sunqm/libcint</a>).  This integral library was
implemented in the model that ensures the compatibility on various high
performance computer systems.  For X86-64 platforms, libcint library has an
efficient counterpart Qcint (<a class="reference external" href="https://github.com/sunqm/qcint">https://github.com/sunqm/qcint</a>)
which is heavily optimized against X86 SIMD instructions (AVX-512/AVX2/AVX/SSE3).
To replace the default libcint library with qcint library, edit the URL
of the integral library in lib/CMakeLists.txt file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ExternalProject_Add</span><span class="p">(</span><span class="n">libcint</span>
   <span class="n">GIT_REPOSITORY</span>
   <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">sunqm</span><span class="o">/</span><span class="n">qcint</span><span class="o">.</span><span class="n">git</span>
   <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="cmake-config-file">
<h2><span class="section-number">3.8. </span>Cmake config file<a class="headerlink" href="#cmake-config-file" title="Permalink to this headline">¶</a></h2>
<p>Cmake options can be saved in a config file <code class="docutils literal notranslate"><span class="pre">pyscf/lib/cmake.arch.inc</span></code>.
Settings in this config file will be automatically loaded and overwritten the
default cmake options during compilation.  For example, you can put
<code class="docutils literal notranslate"><span class="pre">CMAKE_C_FLAGS</span></code> in this config file to include advanced compiler optimization
flags:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">CMAKE_C_FLAGS</span> <span class="s2">&quot;$</span><span class="si">{CMAKE_C_FLAGS}</span><span class="s2"> -ffast-math -mtune=native -march=native&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Other settings and variables and flags can all be put in this config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">ENABLE_XCFUN</span> <span class="n">Off</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="n">WITH_F12</span> <span class="n">Off</span><span class="p">)</span>
</pre></div>
</div>
<p>Some examples of platform specific configurations can be found in directory
<code class="docutils literal notranslate"><span class="pre">pyscf/lib/cmake_arch_config</span></code>.</p>
</div>
<div class="section" id="plugins">
<span id="installing-plugin"></span><h2><span class="section-number">3.9. </span>Plugins<a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h2>
<div class="section" id="nao">
<h3><span class="section-number">3.9.1. </span>NAO<a class="headerlink" href="#nao" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">nao</span></code> module includes the basic functions of numerical atomic orbitals
(NAO) and the (nao based) TDDFT methods.  This module was contributed by Marc
Barbry and Peter Koval.  You can enable this module with a cmake flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cmake -DENABLE_NAO=1 ..
</pre></div>
</div>
<p>More information of the compilation can be found in <code class="file docutils literal notranslate"><span class="pre">pyscf/lib/nao/README.md</span></code>.</p>
</div>
<div class="section" id="dmrg-solver">
<h3><span class="section-number">3.9.2. </span>DMRG solver<a class="headerlink" href="#dmrg-solver" title="Permalink to this headline">¶</a></h3>
<p>Density matrix renormalization group (DMRG) implementations Block
(<a class="reference external" href="https://sanshar.github.io/Block">https://sanshar.github.io/Block</a>) and
CheMPS2 (<a class="reference external" href="http://sebwouters.github.io/CheMPS2/index.html">http://sebwouters.github.io/CheMPS2/index.html</a>)
are efficient DMRG solvers for ab initio quantum chemistry problem.
<a class="reference external" href="https://sanshar.github.io/Block/build.html">Installing Block</a> requires
C++11 compiler.  If C++11 is not supported by your compiler, you can
register and download the precompiled Block binary from
<a class="reference external" href="https://sanshar.github.io/Block/build.html">https://sanshar.github.io/Block/build.html</a>.
Before using the Block or CheMPS2, you need create a configuration file
<code class="docutils literal notranslate"><span class="pre">pyscf/dmrgscf/settings.py</span></code>  (as shown by settings.py.example) to store
the path where the DMRG solver was installed.</p>
</div>
<div class="section" id="id1">
<h3><span class="section-number">3.9.3. </span>Libxc<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>By default, building PySCF will automatically download and install
<a class="reference external" href="http://www.tddft.org/programs/octopus/wiki/index.php/Libxc:download">Libxc 3.0.0</a>.
<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.dft.libxc</span></code> module provided a general interface to access Libxc functionals.</p>
</div>
<div class="section" id="id2">
<h3><span class="section-number">3.9.4. </span>Xcfun<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>By default, building PySCF will automatically download and install
latest xcfun code from <a class="reference external" href="https://github.com/dftlibs/xcfun">https://github.com/dftlibs/xcfun</a>.
<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.dft.xcfun</span></code> module provided a general interface to access Libxc
functionals.</p>
</div>
<div class="section" id="tblis">
<h3><span class="section-number">3.9.5. </span>TBLIS<a class="headerlink" href="#tblis" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/devinamatthews/tblis">TBLIS</a> provides a native algorithm
to perform tensor contraction for arbitrary high dimensional tensors. The native
algorithm does not need to transform tensors into matrices then call the BLAS
libraries for the matrix contraction.  Tensor transposing and data moving are
largely avoided in TBLIS tensor library.  The interface to TBLIS offers an
efficient implementation for <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.einsum()</span></code> style tensor contraction.
To enable the tlibs-einsum plugin, you can set the cmake flags
<code class="docutils literal notranslate"><span class="pre">-DENABLE_TBLIS</span></code> when compiling the C extensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cmake -DENABLE_TBLIS=ON ..
</pre></div>
</div>
<p>Note TBLIS library was implemented with C++11 standard. You need at least GCC
5.2 to compile this plugin.</p>
</div>
<div class="section" id="pyberny">
<h3><span class="section-number">3.9.6. </span>Pyberny<a class="headerlink" href="#pyberny" title="Permalink to this headline">¶</a></h3>
<p>The geometry optimizer <a class="reference external" href="https://github.com/jhrmnn/pyberny">Pyberny</a> provides an
independent implementation that supports various geometry optimization
techniques (comprising redundant internal coordinates, iterative Hessian
estimate, trust region, line search, and coordinate weighing etc.).  It can take
the output of PySCF Gradients <a class="reference internal" href="overview.html#scanner"><span class="std std-ref">Scanner</span></a> and generate new geometry to feed
back to PySCF program.  The geometry optimization <code class="xref py py-mod docutils literal notranslate"><span class="pre">geomopt</span></code> exposes a
wrapper function to simplify the geometry optimization setup:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">geomopt</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span>
<span class="n">mol_eq</span> <span class="o">=</span> <span class="n">geomopt</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code-rule.html" class="btn btn-neutral float-right" title="4. Code standard" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="version.html" class="btn btn-neutral float-left" title="2. Version history" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, The PySCF Developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>